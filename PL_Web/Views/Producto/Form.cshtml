@model ML.Producto
@*@model ML.Usuario*@
@{
    ViewBag.Title = "Form";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string src = Model.ImagenBase64 != null && Model.ImagenBase64 != "" ? "data:image/png;base64," + Model.ImagenBase64 : "/content/imagenes/SinIngredientes.png";
}
<link rel="stylesheet" href="https://code.jquery.com/ui/1.14.1/themes/base/jquery-ui.css">
<h2>Nuevo Producto</h2>
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <div class="card p-4 shadow">
                @using (Html.BeginForm("Form", "Producto", FormMethod.Post, new
                {
                    @enctype = "multipart/form-data",
                    @onsubmit = "Enviar(event)"
                }))
                {
                    @Html.HiddenFor(model => model.IdProducto)
                    @Html.HiddenFor(model => model.Imagen)
                    <div class="text-center mb-4">
                        <img src="@src" style="width:15%" alt="Imagen producto" id="imagenProducto" />
                        <div class="col mt-2">
                            <label for="form-label">Imagen del producto</label>
                            <input onchange="IsImage()" id="inptImagen" name="ImagenUpload" class="form-control mx-auto" type="file">
                        </div>
                    </div>
                    <div class="row mb-4">
                        <div class="col-md-3">
                            @Html.LabelFor(model => model.Nombre, new { @class = "form-label" })
                            @Html.TextBoxFor(model => model.Nombre, new { @class = "form-control", @placeholder = "", @onkeypress = "SoloLetras(event)" })
                            @Html.ValidationMessageFor(model => model.Nombre, "", new { @class = "text-danger" })
                            <div class="error"></div>
                        </div>
                        <div class="col-md-3">
                            @Html.LabelFor(model => model.Precio, new { @class = "form-label" })
                            @Html.TextBoxFor(model => model.Precio, new { @class = "form-control", @placeholder = "", @onkeypress = "SoloNumeros(event)", @onblur = "validarNumeroCompleto(event)" })
                            @Html.ValidationMessageFor(model => model.Precio, "", new { @class = "text-danger" })
                            <div class="error"></div>
                        </div>
                        <div class="col-md-3">
                            @Html.LabelFor(model => model.SubCategoria.Categoria.IdCategoria, new { @class = "form-label" })
                            @Html.DropDownListFor(model => model.SubCategoria.Categoria.IdCategoria, new SelectList(Model.SubCategoria.Categoria.Categorias, "IdCategoria", "Nombre"), "Seleccione una Categoria", new { @class = "form-select", @onchange = "GetSubCategoriaByIdSubCategoria()", @id = "ddlCategoria" })
                            @Html.ValidationMessageFor(model => model.SubCategoria.Categoria.IdCategoria, "", new { @class = "text-danger" })
                            <div class="error"></div>
                        </div>
                        <div class="col-md-3">
                            @Html.LabelFor(model => model.SubCategoria.IdSubCategoria, new { @class = "form-label" })
                            @if (Model.SubCategoria.SubCategorias != null && Model.SubCategoria.SubCategorias.Count() > 0)
                            {
                                @Html.DropDownListFor(model => model.SubCategoria.IdSubCategoria, new SelectList(Model.SubCategoria.SubCategorias, "IdSubCategoria", "Nombre"), "Seleccione una subcategoria", new { @class = "form-select ", @onchange = "ValidateSelect('ddlSubCategoria')", @id = "ddlSubCategoria" })
                            }
                            else
                            {
                                @Html.DropDownListFor(model => model.SubCategoria.IdSubCategoria, new SelectList(String.Empty), "Seleccione una subcategoria", new { @class = "form-select ", @onchange = "ValidateSelect('ddlSubCategoria')", @id = "ddlSubCategoria" })
                            }
                            @Html.ValidationMessageFor(model => model.SubCategoria.IdSubCategoria, "", new { @class = "text-danger" })
                            <div class="error"></div>
                        </div>
                    </div>
                    <div class="row mb-4">
                        <div class="col-md-12">
                            @Html.LabelFor(model => model.Descripcion, new { @class = "form-label" })
                            @Html.TextAreaFor(model => model.Descripcion, new { @class = "form-control", @placeholder = "", @rows = "2", @cols = "100" })
                            @Html.ValidationMessageFor(model => model.Descripcion, "", new { @class = "text-danger" })
                            <div class="error"></div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <div class="row mt-2">
                            <div class="col-6 text-start">
                                <a href="@Url.Action("GetAll", "Producto")" class="btn btn-danger">
                                    Cancelar
                                    <i class="bi bi-x-square-fill"></i>
                                </a>
                            </div>
                            <div class="col-6 text-end">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-floppy2-fill"></i>
                                    Guardar
                                </button>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@Scripts.Render("~/bundles/jquery")
<script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
<script>
    var urlGetByIdCategoria = '@Url.Action("GetByIdCategoria", "Producto")?IdCategoria='
</script>
<script src="~/Scripts/Espesifics/Producto/ProductoForm.js"></script>

